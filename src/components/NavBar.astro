---
interface Props {
  currentPath?: string;
}

const { currentPath = "/" } = Astro.props;

const links = [
  { href: "/product", label: "Product" },
  { href: "/how-it-works", label: "How it works" },
  { href: "/pricing", label: "Pricing" },
  { href: "/samples", label: "Samples" },
  { href: "/faq", label: "FAQ" },
  { href: "/about", label: "About" },
  { href: "/contact", label: "Contact" }
];

const isActive = (href: string) =>
  currentPath === href || (href !== "/" && currentPath?.startsWith(href));
---

<nav class="fixed inset-x-0 top-0 z-40 bg-bgNeutral/95 backdrop-blur border-b border-borderSoft">
  <div class="max-w-6xl mx-auto px-4 md:px-6 flex items-center justify-between h-16 md:h-20">
    <a href="/" class="flex items-center gap-2" aria-label="SimReact home">
      <div class="w-9 h-9 rounded-lg border border-ink flex items-center justify-center text-xs font-semibold text-ink tracking-tight">
        SR
      </div>
      <div class="flex flex-col leading-tight">
        <span class="font-serif text-[18px] text-ink">SimReact</span>
        <span class="text-[10px] uppercase tracking-[0.16em] text-slate-500">
          Synthetic Audience Testing
        </span>
      </div>
    </a>

    <div class="hidden lg:flex items-center gap-6">
      <ul class="flex items-center gap-5 text-[13px] text-slate-700">
        {links.map((link) => (
          <li>
            <a
              href={link.href}
              class={`hover:text-ink transition-colors ${isActive(link.href) ? "text-ink font-semibold" : ""}`}
            >
              {link.label}
            </a>
          </li>
        ))}
      </ul>
      <a href="/contact" class="btn-primary text-xs">
        Request a Pilot
      </a>
    </div>

    <div class="lg:hidden">
      <button
        class="inline-flex items-center justify-center w-9 h-9 rounded-full border border-slate-300 bg-white text-slate-800"
        aria-label="Toggle navigation menu"
        id="nav-toggle"
      >
        <span class="sr-only">Menu</span>
        <div class="space-y-1.5">
          <div class="w-4 h-0.5 bg-slate-800"></div>
          <div class="w-4 h-0.5 bg-slate-800"></div>
        </div>
      </button>
    </div>
  </div>

  <div
    id="mobile-menu"
    class="lg:hidden origin-top scale-y-0 opacity-0 pointer-events-none transform transition-all duration-150 border-t border-borderSoft bg-bgNeutral"
  >
    <div class="max-w-6xl mx-auto px-4 pb-4 pt-2 flex flex-col gap-2 text-sm">
      {links.map((link) => (
        <a
          href={link.href}
          class={`py-1.5 ${isActive(link.href) ? "text-ink font-semibold" : "text-slate-700"}`}
        >
          {link.label}
        </a>
      ))}
      <a href="/contact" class="mt-2 btn-primary w-full justify-center">
        Request a Pilot
      </a>
    </div>
  </div>

  <script>
    if (typeof window !== 'undefined') {
      const toggle = document.getElementById('nav-toggle');
      const menu = document.getElementById('mobile-menu');
      if (toggle && menu) {
        toggle.addEventListener('click', () => {
          const isOpen = menu.classList.contains('scale-y-100');
          if (isOpen) {
            menu.classList.remove('scale-y-100', 'opacity-100');
            menu.classList.add('scale-y-0', 'opacity-0', 'pointer-events-none');
          } else {
            menu.classList.remove('scale-y-0', 'opacity-0', 'pointer-events-none');
            menu.classList.add('scale-y-100', 'opacity-100');
          }
        });
      }
    }
  </script>
</nav>
